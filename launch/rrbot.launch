<?xml version="1.0"?>
<launch>
  <arg name="display_plots" default="false"/>
  <arg name="gtest_filter" default="*"/>

  <!-- Model -->
  <param
    name="robot_description"
    command="$(find xacro)/xacro '$(find basic_velocity_control/description/rrbot.xacro'"
  />

  <!-- Hardware -->
  <node
    name="rrbothw"
    pkg="basic_velocity_control"
    type="rrbothw"
  />

  <!-- Configuration -->
  <rosparam
    command="load"
    file="$(find basic_velocity_control)/config/controllers.yaml"
  />

  <!-- Velocity Controller -->
  <node
    name="controller_spawner"
    pkg="controller_manager"
    type="spawner"
    output="screen"
    args="rrbot_controller"
  />

  <!-- Plots -->
  <node
    name="rrbot_pos_monitor"
    pkg="rqt_plot"
    type="rqt_plot"
    args="/rrbot_controller/state/desired/positions[0]:positions[1],/rrbot_controller/state/actual/positions[0]:positions[1]"
  />
  <node
    name="rrbot_vel_monitor"
    pkg="rqt_plot"
    type="rqt_plot"
    args="/rrbot_controller/state/desired/velocities[0]:velocities[1],/rrbot_controller/state/actual/velocities[0]:velocities[1]"
  />
</launch>
